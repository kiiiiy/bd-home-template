본 백엔드는 JWT 기반 관리자 로그인 구조이며, 관리자 비밀번호는 환경변수 + BCrypt 해시로 관리합니다.

기존 비밀번호에서 새 비밀번호로 변경 시 해야할 설정을 안내드립니다.

서버에는 비밀번호 원문이 없으며 비밀번호의 BCrypt 해시값만 저장 하고 로그인 시 입력한 비밀번호를 해시와 비교하는 구조입니다.

### 1. 새 비밀번호 정하기

- git에 남기면 안됩니다. 임원진들 간 개인적인 공유 부탁드립니다.

### 2. BCrypt 해시 생성

- 아무 Java 파일을 임시로 하나 만들어서 실행합니다 (실행 후 파일 삭제)

```java
public class PasswordHashGenerator {
    public static void main(String[] args) {
        System.out.println(
            new org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder()
                .encode("새 비밀번호")
        );
    }
}
```

실행 결과 예시:

```java
$2a$10$kzrdfdfgwkdjndfks3ky.9f.QS7gr9qtJjdfs6n3eeiDLn0.3sAUu
```
위의 해시값은 예시를 위해 임의로 작성한 것입니다.
### 3. bash 실행

gradlew 파일이 있는 폴더에서 아래 명령문을 입력해주시면 됩니다.

```bash
export ADMIN_PASSWORD_HASH='$2a$10$kzrdfdfgwkdjndfks3ky.9f.QS7gr9qtJjdfs6n3eeiDLn0.3sAUu'
export JWT_SECRET='기존 JWT SECRET'

./gradlew bootRun
```

### 4. fly.io에서 교체

저희는 fly.io를 통해 배포하였기에 fly secrets를 변경해주시면 됩니다.

```
fly secrets set ADMIN_PASSWORD_HASH=$2a$10$kzrdfdfgwkdjndfks3ky.9f.QS7gr9qtJjdfs6n3eeiDLn0.3sAUu
```

### 5. 변경 후 확인
서버를 실행한 bash창이 아닌, 다른 bash 창을 열어 그 곳에 입력해주세요.

```bash
curl -X POST http://localhost:8080/api/admin/auth/login \
  -H "Content-Type: application/json" \
  -d '{"password":"새 비밀번호"}'
```

- 200 + accessToken → 성공
- 401 → 해시/비밀번호 불일치
